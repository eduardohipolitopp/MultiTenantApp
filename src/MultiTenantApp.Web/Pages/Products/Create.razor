@page "/products/create"
@using MultiTenantApp.Web.Models.DTOs
@using MultiTenantApp.Web.Services
@using MultiTenantApp.Web.Components.Products
@using ProductsRes = MultiTenantApp.Web.Resources.Pages.Products
@inject IProductService ProductService
@inject NavigationManager Navigation
@inject ISnackbar Snackbar

<MudText Typo="Typo.h4" Class="mb-4">@ProductsRes.CreateProduct</MudText>

<MudPaper Class="pa-4">
    <ProductForm Model="model" ButtonText="@ProductsRes.Create" OnValidSubmit="New" />
</MudPaper>

@code {
    private CreateProductDto model = new();

    private async Task New()
    {
        try
        {
            await ProductService.CreateAsync(model);
            Snackbar.Add(ProductsRes.ProductCreatedSuccess, Severity.Success);
            Navigation.NavigateTo("/products");
        }
        catch (Exception ex)
        {
            Snackbar.Add($"Error: {ex.Message}", Severity.Error);
        }
    }
}
